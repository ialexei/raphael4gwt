/*! raphael4gwt 2013-08-26 */
!function(){function a(a,b,c,d,e,f){function g(a,b,c,d,e){var f=Math.PI/180,g=a+c*Math.cos(-d*f),h=a+c*Math.cos(-e*f),i=a+c/2*Math.cos(-(d+(e-d)/2)*f),j=b+c*Math.sin(-d*f),k=b+c*Math.sin(-e*f),l=b+c/2*Math.sin(-(d+(e-d)/2)*f),m=["M",a,b,"L",g,j,"A",c,c,0,+(Math.abs(e-d)>180),1,h,k,"z"];return m.middle={x:i,y:l},m}f=f||{};var h=this,i=[],j=a.set(),k=a.set(),l=a.set(),m=e.length,n=0,o=0,p=0,q=f.maxSlices||100,r=parseFloat(f.minPercent)||1,s=Boolean(r);if(k.covers=j,1==m)l.push(a.circle(b,c,d).attr({fill:f.colors&&f.colors[0]||h.colors[0],stroke:f.stroke||"#fff","stroke-width":null==f.strokewidth?1:f.strokewidth})),j.push(a.circle(b,c,d).attr(h.shim)),o=e[0],e[0]={value:e[0],order:0,valueOf:function(){return this.value}},f.href&&f.href[0]&&j[0].attr({href:f.href[0]}),l[0].middle={x:b,y:c},l[0].mangle=180;else{for(var t=0;m>t;t++)o+=e[t],e[t]={value:e[t],order:t,valueOf:function(){return this.value}};for(e.sort(function(a,b){return b.value-a.value}),t=0;m>t;t++)s&&100*e[t]/o<r&&(q=t,s=!1),t>q&&(s=!1,e[q].value+=e[t],e[q].others=!0,p=e[q].value);for(m=Math.min(q+1,e.length),p&&e.splice(m)&&(e[q].others=!0),t=0;m>t;t++){var u=n-360*e[t]/o/2;if(t||(n=90-u,u=n-360*e[t]/o/2),f.init)var v=g(b,c,1,n,n-360*e[t]/o).join(",");var w=g(b,c,d,n,n-=360*e[t]/o),x=f.matchColors&&1==f.matchColors?e[t].order:t,y=a.path(f.init?v:w).attr({fill:f.colors&&f.colors[x]||h.colors[x]||"#666",stroke:f.stroke||"#fff","stroke-width":null==f.strokewidth?1:f.strokewidth,"stroke-linejoin":"round"});y.value=e[t],y.middle=w.middle,y.mangle=u,i.push(y),l.push(y),f.init&&y.animate({path:w.join(",")},+f.init-1||1e3,">")}for(t=0;m>t;t++){y=a.path(i[t].attr("path")).attr(h.shim);var x=e[t].order;f.href&&f.href[x]&&y.attr({href:f.href[x]}),y.attr=function(){},j.push(y),l.push(y)}}k.hover=function(a,f){f=f||function(){};for(var g=this,h=0;m>h;h++)!function(h,i,j){var k={sector:h,cover:i,cx:b,cy:c,mx:h.middle.x,my:h.middle.y,mangle:h.mangle,r:d,value:e[j],total:o,label:g.labels&&g.labels[j]};i.mouseover(function(){a.call(k)}).mouseout(function(){f.call(k)})}(l[h],j[h],h);return this},k.each=function(a){for(var f=this,g=0;m>g;g++)!function(g,h,i){var j={sector:g,cover:h,cx:b,cy:c,x:g.middle.x,y:g.middle.y,mangle:g.mangle,r:d,value:e[i],total:o,label:f.labels&&f.labels[i]};a.call(j)}(l[g],j[g],g);return this},k.click=function(a){for(var f=this,g=0;m>g;g++)!function(g,h,i){var j={sector:g,cover:h,cx:b,cy:c,mx:g.middle.x,my:g.middle.y,mangle:g.mangle,r:d,value:e[i],total:o,label:f.labels&&f.labels[i]};h.click(function(){a.call(j)})}(l[g],j[g],g);return this},k.inject=function(a){a.insertBefore(j[0])};var z=function(g,i,n,p){var q=b+d+d/5,r=c,s=r+10;g=g||[],p=p&&p.toLowerCase&&p.toLowerCase()||"east",n=a[n&&n.toLowerCase()]||"circle",k.labels=a.set();for(var t=0;m>t;t++){var u,v=l[t].attr("fill"),w=e[t].order;e[t].others&&(g[w]=i||"Others"),g[w]=h.labelise(g[w],e[t],o),k.labels.push(a.set()),k.labels[t].push(a[n](q+5,s,5).attr({fill:v,stroke:"none"})),k.labels[t].push(u=a.text(q+20,s,g[w]||e[w]).attr(h.txtattr).attr({fill:f.legendcolor||"#000","text-anchor":"start"})),j[t].label=k.labels[t],s+=1.2*u.getBBox().height}var x=k.labels.getBBox(),y={east:[0,-x.height/2],west:[-x.width-2*d-20,-x.height/2],north:[-d-x.width/2,-d-x.height-10],south:[-d-x.width/2,d+10]}[p];k.labels.translate.apply(k.labels,y),k.push(k.labels)};return f.legend&&z(f.legend,f.legendothers,f.legendmark,f.legendpos),k.push(l,j),k.series=l,k.covers=j,k}var b=function(){};b.prototype=Raphael.g,a.prototype=new b,Raphael.fn.piechart=function(b,c,d,e,f){return new a(this,b,c,d,e,f)}}();