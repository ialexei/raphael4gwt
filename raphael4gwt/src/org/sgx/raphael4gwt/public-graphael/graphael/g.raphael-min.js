/*! raphael4gwt 2013-08-26 */
Raphael.el.popup=function(a,b,c,d){var e,f,g,h,i,j=this.paper||this[0].paper;if(j){switch(this.type){case"text":case"circle":case"ellipse":g=!0;break;default:g=!1}a=null==a?"up":a,b=b||5,e=this.getBBox(),c="number"==typeof c?c:g?e.x+e.width/2:e.x,d="number"==typeof d?d:g?e.y+e.height/2:e.y,h=Math.max(e.width/2-b,0),i=Math.max(e.height/2-b,0),this.translate(c-e.x-(g?e.width/2:0),d-e.y-(g?e.height/2:0)),e=this.getBBox();var k={up:["M",c,d,"l",-b,-b,-h,0,"a",b,b,0,0,1,-b,-b,"l",0,-e.height,"a",b,b,0,0,1,b,-b,"l",2*b+2*h,0,"a",b,b,0,0,1,b,b,"l",0,e.height,"a",b,b,0,0,1,-b,b,"l",-h,0,"z"].join(","),down:["M",c,d,"l",b,b,h,0,"a",b,b,0,0,1,b,b,"l",0,e.height,"a",b,b,0,0,1,-b,b,"l",-(2*b+2*h),0,"a",b,b,0,0,1,-b,-b,"l",0,-e.height,"a",b,b,0,0,1,b,-b,"l",h,0,"z"].join(","),left:["M",c,d,"l",-b,b,0,i,"a",b,b,0,0,1,-b,b,"l",-e.width,0,"a",b,b,0,0,1,-b,-b,"l",0,-(2*b+2*i),"a",b,b,0,0,1,b,-b,"l",e.width,0,"a",b,b,0,0,1,b,b,"l",0,i,"z"].join(","),right:["M",c,d,"l",b,-b,0,-i,"a",b,b,0,0,1,b,-b,"l",e.width,0,"a",b,b,0,0,1,b,b,"l",0,2*b+2*i,"a",b,b,0,0,1,-b,b,"l",-e.width,0,"a",b,b,0,0,1,-b,-b,"l",0,-i,"z"].join(",")};return f={up:{x:-!g*(e.width/2),y:2*-b-(g?e.height/2:e.height)},down:{x:-!g*(e.width/2),y:2*b+(g?e.height/2:e.height)},left:{x:2*-b-(g?e.width/2:e.width),y:-!g*(e.height/2)},right:{x:2*b+(g?e.width/2:e.width),y:-!g*(e.height/2)}}[a],this.translate(f.x,f.y),j.path(k[a]).attr({fill:"#000",stroke:"none"}).insertBefore(this.node?this:this[0])}},Raphael.el.tag=function(a,b,c,d){var e=3,f=this.paper||this[0].paper;if(f){var g,h,i,j=f.path().attr({fill:"#000",stroke:"#000"}),k=this.getBBox();switch(this.type){case"text":case"circle":case"ellipse":i=!0;break;default:i=!1}return a=a||0,c="number"==typeof c?c:i?k.x+k.width/2:k.x,d="number"==typeof d?d:i?k.y+k.height/2:k.y,b=null==b?5:b,h=.5522*b,k.height>=2*b?j.attr({path:["M",c,d+b,"a",b,b,0,1,1,0,2*-b,b,b,0,1,1,0,2*b,"m",0,2*-b-e,"a",b+e,b+e,0,1,0,0,2*(b+e),"L",c+b+e,d+k.height/2+e,"l",k.width+2*e,0,0,-k.height-2*e,-k.width-2*e,0,"L",c,d-b-e].join(",")}):(g=Math.sqrt(Math.pow(b+e,2)-Math.pow(k.height/2+e,2)),j.attr({path:["M",c,d+b,"c",-h,0,-b,h-b,-b,-b,0,-h,b-h,-b,b,-b,h,0,b,b-h,b,b,0,h,h-b,b,-b,b,"M",c+g,d-k.height/2-e,"a",b+e,b+e,0,1,0,0,k.height+2*e,"l",b+e-g+k.width+2*e,0,0,-k.height-2*e,"L",c+g,d-k.height/2-e].join(",")})),a=360-a,j.rotate(a,c,d),this.attrs?(this.attr(this.attrs.x?"x":"cx",c+b+e+(i?k.width/2:"text"==this.type?k.width:0)).attr("y",i?d:d-k.height/2),this.rotate(a,c,d),a>90&&270>a&&this.attr(this.attrs.x?"x":"cx",c-b-e-(i?k.width/2:k.width)).rotate(180,c,d)):a>90&&270>a?(this.translate(c-k.x-k.width-b-e,d-k.y-k.height/2),this.rotate(a-180,k.x+k.width+b+e,k.y+k.height/2)):(this.translate(c-k.x+b+e,d-k.y-k.height/2),this.rotate(a,k.x-b-e,k.y+k.height/2)),j.insertBefore(this.node?this:this[0])}},Raphael.el.drop=function(a,b,c){var d,e,f,g,h,i=this.getBBox(),j=this.paper||this[0].paper;if(j){switch(this.type){case"text":case"circle":case"ellipse":d=!0;break;default:d=!1}return a=a||0,b="number"==typeof b?b:d?i.x+i.width/2:i.x,c="number"==typeof c?c:d?i.y+i.height/2:i.y,e=Math.max(i.width,i.height)+Math.min(i.width,i.height),f=j.path(["M",b,c,"l",e,0,"A",.4*e,.4*e,0,1,0,b+.7*e,c-.7*e,"z"]).attr({fill:"#000",stroke:"none"}).rotate(22.5-a,b,c),a=(a+90)*Math.PI/180,g=b+e*Math.sin(a)-(d?0:i.width/2),h=c+e*Math.cos(a)-(d?0:i.height/2),this.attrs?this.attr(this.attrs.x?"x":"cx",g).attr(this.attrs.y?"y":"cy",h):this.translate(g-i.x,h-i.y),f.insertBefore(this.node?this:this[0])}},Raphael.el.flag=function(a,b,c){var d=3,e=this.paper||this[0].paper;if(e){var f,g=e.path().attr({fill:"#000",stroke:"#000"}),h=this.getBBox(),i=h.height/2;switch(this.type){case"text":case"circle":case"ellipse":f=!0;break;default:f=!1}return a=a||0,b="number"==typeof b?b:f?h.x+h.width/2:h.x,c="number"==typeof c?c:f?h.y+h.height/2:h.y,g.attr({path:["M",b,c,"l",i+d,-i-d,h.width+2*d,0,0,h.height+2*d,-h.width-2*d,0,"z"].join(",")}),a=360-a,g.rotate(a,b,c),this.attrs?(this.attr(this.attrs.x?"x":"cx",b+i+d+(f?h.width/2:"text"==this.type?h.width:0)).attr("y",f?c:c-h.height/2),this.rotate(a,b,c),a>90&&270>a&&this.attr(this.attrs.x?"x":"cx",b-i-d-(f?h.width/2:h.width)).rotate(180,b,c)):a>90&&270>a?(this.translate(b-h.x-h.width-i-d,c-h.y-h.height/2),this.rotate(a-180,h.x+h.width+i+d,h.y+h.height/2)):(this.translate(b-h.x+i+d,c-h.y-h.height/2),this.rotate(a,h.x-i-d,h.y+h.height/2)),g.insertBefore(this.node?this:this[0])}},Raphael.el.label=function(){var a=this.getBBox(),b=this.paper||this[0].paper,c=Math.min(20,a.width+10,a.height+10)/2;if(b)return b.rect(a.x-c/2,a.y-c/2,a.width+c,a.height+c,c).attr({stroke:"none",fill:"#000"}).insertBefore(this.node?this:this[0])},Raphael.el.blob=function(a,b,c){var d,e,f,g=this.getBBox(),h=Math.PI/180,i=this.paper||this[0].paper;if(i){switch(this.type){case"text":case"circle":case"ellipse":e=!0;break;default:e=!1}d=i.path().attr({fill:"#000",stroke:"none"}),a=(+a+1?a:45)+90,f=Math.min(g.height,g.width),b="number"==typeof b?b:e?g.x+g.width/2:g.x,c="number"==typeof c?c:e?g.y+g.height/2:g.y;var j=Math.max(g.width+f,25*f/12),k=Math.max(g.height+f,25*f/12),l=b+f*Math.sin((a-22.5)*h),m=c+f*Math.cos((a-22.5)*h),n=b+f*Math.sin((a+22.5)*h),o=c+f*Math.cos((a+22.5)*h),p=(n-l)/2,q=(o-m)/2,r=j/2,s=k/2,t=-Math.sqrt(Math.abs(r*r*s*s-r*r*q*q-s*s*p*p)/(r*r*q*q+s*s*p*p)),u=t*r*q/s+(n+l)/2,v=t*-s*p/r+(o+m)/2;return d.attr({x:u,y:v,path:["M",b,c,"L",n,o,"A",r,s,0,1,1,l,m,"z"].join(",")}),this.translate(u-g.x-g.width/2,v-g.y-g.height/2),d.insertBefore(this.node?this:this[0])}},Raphael.fn.label=function(a,b,c){var d=this.set();return c=this.text(a,b,c).attr(Raphael.g.txtattr),d.push(c.label(),c)},Raphael.fn.popup=function(a,b,c,d,e){var f=this.set();return c=this.text(a,b,c).attr(Raphael.g.txtattr),f.push(c.popup(d,e,a,b),c)},Raphael.fn.tag=function(a,b,c,d,e){var f=this.set();return c=this.text(a,b,c).attr(Raphael.g.txtattr),f.push(c.tag(d,e),c)},Raphael.fn.flag=function(a,b,c,d){var e=this.set();return c=this.text(a,b,c).attr(Raphael.g.txtattr),e.push(c.flag(d),c)},Raphael.fn.drop=function(a,b,c,d){var e=this.set();return c=this.text(a,b,c).attr(Raphael.g.txtattr),e.push(c.drop(d),c)},Raphael.fn.blob=function(a,b,c,d){var e=this.set();return c=this.text(a,b,c).attr(Raphael.g.txtattr),e.push(c.blob(d),c)},Raphael.el.lighter=function(a){a=a||2;var b=[this.attrs.fill,this.attrs.stroke];return this.fs=this.fs||[b[0],b[1]],b[0]=Raphael.rgb2hsb(Raphael.getRGB(b[0]).hex),b[1]=Raphael.rgb2hsb(Raphael.getRGB(b[1]).hex),b[0].b=Math.min(b[0].b*a,1),b[0].s=b[0].s/a,b[1].b=Math.min(b[1].b*a,1),b[1].s=b[1].s/a,this.attr({fill:"hsb("+[b[0].h,b[0].s,b[0].b]+")",stroke:"hsb("+[b[1].h,b[1].s,b[1].b]+")"}),this},Raphael.el.darker=function(a){a=a||2;var b=[this.attrs.fill,this.attrs.stroke];return this.fs=this.fs||[b[0],b[1]],b[0]=Raphael.rgb2hsb(Raphael.getRGB(b[0]).hex),b[1]=Raphael.rgb2hsb(Raphael.getRGB(b[1]).hex),b[0].s=Math.min(b[0].s*a,1),b[0].b=b[0].b/a,b[1].s=Math.min(b[1].s*a,1),b[1].b=b[1].b/a,this.attr({fill:"hsb("+[b[0].h,b[0].s,b[0].b]+")",stroke:"hsb("+[b[1].h,b[1].s,b[1].b]+")"}),this},Raphael.el.resetBrightness=function(){return this.fs&&(this.attr({fill:this.fs[0],stroke:this.fs[1]}),delete this.fs),this},function(){var a=["lighter","darker","resetBrightness"],b=["popup","tag","flag","label","drop","blob"];for(var c in b)!function(a){Raphael.st[a]=function(){return Raphael.el[a].apply(this,arguments)}}(b[c]);for(var c in a)!function(a){Raphael.st[a]=function(){for(var b=0;b<this.length;b++)this[b][a].apply(this[b],arguments);return this}}(a[c])}(),Raphael.g={shim:{stroke:"none",fill:"#000","fill-opacity":0},txtattr:{font:"12px Arial, sans-serif",fill:"#fff"},colors:function(){for(var a=[.6,.2,.05,.1333,.75,0],b=[],c=0;10>c;c++)c<a.length?b.push("hsb("+a[c]+",.75, .75)"):b.push("hsb("+a[c-a.length]+", 1, .5)");return b}(),snapEnds:function(a,b,c){function d(a){return Math.abs(a-.5)<.25?~~a+.5:Math.round(a)}var e=a,f=b;if(e==f)return{from:e,to:f,power:0};var g=(f-e)/c,h=~~g,i=h,j=0;if(h){for(;i;)j--,i=~~(g*Math.pow(10,j))/Math.pow(10,j);j++}else{if(0!=g&&isFinite(g))for(;!h;)j=j||1,h=~~(g*Math.pow(10,j))/Math.pow(10,j),j++;else j=1;j&&j--}return f=d(b*Math.pow(10,j))/Math.pow(10,j),b>f&&(f=d((b+.5)*Math.pow(10,j))/Math.pow(10,j)),e=d((a-(j>0?0:.5))*Math.pow(10,j))/Math.pow(10,j),{from:e,to:f,power:j}},axis:function(a,b,c,d,e,f,g,h,i,j,k){j=null==j?2:j,i=i||"t",f=f||10,k=arguments[arguments.length-1];var l,m="|"==i||" "==i?["M",a+.5,b,"l",0,.001]:1==g||3==g?["M",a+.5,b,"l",0,-c]:["M",a,b+.5,"l",c,0],n=this.snapEnds(d,e,f),o=n.from,p=n.to,q=n.power,r=0,s={font:"11px 'Fontin Sans', Fontin-Sans, sans-serif"},t=k.set();l=(p-o)/f;var u=o,v=q>0?q:0;if(z=c/f,1==+g||3==+g){for(var w=b,x=(g-1?1:-1)*(j+3+!!(g-1));w>=b-c;)"-"!=i&&" "!=i&&(m=m.concat(["M",a-("+"==i||"|"==i?j:2*!(g-1)*j),w+.5,"l",2*j+1,0])),t.push(k.text(a+x,w,h&&h[r++]||(Math.round(u)==u?u:+u.toFixed(v))).attr(s).attr({"text-anchor":g-1?"start":"end"})),u+=l,w-=z;Math.round(w+z-(b-c))&&("-"!=i&&" "!=i&&(m=m.concat(["M",a-("+"==i||"|"==i?j:2*!(g-1)*j),b-c+.5,"l",2*j+1,0])),t.push(k.text(a+x,b-c,h&&h[r]||(Math.round(u)==u?u:+u.toFixed(v))).attr(s).attr({"text-anchor":g-1?"start":"end"})))}else{u=o,v=(q>0)*q,x=(g?-1:1)*(j+9+!g);for(var y=a,z=c/f,A=0,B=0;a+c>=y;){"-"!=i&&" "!=i&&(m=m.concat(["M",y+.5,b-("+"==i?j:2*!!g*j),"l",0,2*j+1])),t.push(A=k.text(y,b+x,h&&h[r++]||(Math.round(u)==u?u:+u.toFixed(v))).attr(s));var C=A.getBBox();B>=C.x-5?t.pop(t.length-1).remove():B=C.x+C.width,u+=l,y+=z}Math.round(y-z-a-c)&&("-"!=i&&" "!=i&&(m=m.concat(["M",a+c+.5,b-("+"==i?j:2*!!g*j),"l",0,2*j+1])),t.push(k.text(a+c,b+x,h&&h[r]||(Math.round(u)==u?u:+u.toFixed(v))).attr(s)))}var D=k.path(m);return D.text=t,D.all=k.set([D,t]),D.remove=function(){this.text.remove(),this.constructor.prototype.remove.call(this)},D},labelise:function(a,b,c){return a?(a+"").replace(/(##+(?:\.#+)?)|(%%+(?:\.%+)?)/g,function(a,d,e){return d?(+b).toFixed(d.replace(/^#+\.?/g,"").length):e?(100*b/c).toFixed(e.replace(/^%+\.?/g,"").length)+"%":void 0}):(+b).toFixed(0)}};